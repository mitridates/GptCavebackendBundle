{#
/**
 * @file contact.html.twig
 * @parent ../edit.html.twig
 */
#}
{% set country_attr= {attr: {'data-child': '#'~form.admin1address.vars.id}} %}

{% set admin1_attr= {attr: {
    'data-child': '#'~form.admin2address.vars.id,
    'data-url': path('cave_backend_json_admin1'),
    'data-parentid': 'countryid',
    'data-placeholder': 'select.government.level.admin1'|trans({},'cavemessages')|raw,
}}%}

{% set admin2_attr= {attr: {
    'data-child': '#'~form.admin3address.vars.id,
    'data-url': path('cave_backend_json_admin2'),
    'data-parentid': 'admin1id',
    'data-placeholder': 'select.government.level.admin2'|trans({},'cavemessages')|raw
}}%}

{% set admin3_attr= {attr: {
    'data-url': path('cave_backend_json_admin3'),
    'data-parentid': 'admin2id',
    'data-placeholder': 'select.government.level.admin3'|trans({},'cavemessages')|raw,
}}%}
{% embed '@GptCavebackend/partial/page/panel.html.twig' with {type: arrayParams.page.style.form_panel }%}
{% block heading %}{{ 'organisation.edit.form.contact'|trans({},'cavepages')|raw }}{% endblock heading %}
{% block body %}

<table class="table">
    <tr>
        <td>{{ form_label(form.countryaddress)}}</td>
        <td>{{ form_label(form.admin1address)}}</td>
        <td>{{ form_label(form.admin2address)}}</td>
        <td>{{ form_label(form.admin3address)}}</td>
    </tr>
    <tr>
        <td>{{ form_widget(form.countryaddress, country_attr)}}</td>
        <td>{{ form_widget(form.admin1address, admin1_attr)}}</td>
        <td>{{ form_widget(form.admin2address, admin2_attr)}}</td>
        <td>{{ form_widget(form.admin3address, admin3_attr)}}</td>
    </tr>
</table>
    <script>
        $(document).ready(function() {
            let repo = new Repopulate( '#{{ form.countryaddress.vars.id }}');
            repo.on('ev.onLoadResponse', (data, el, attr)=>{
                return JSON.parse(data.response).out;//data is in 'out' array
            });
            repo.bindAll();
        });
    </script>
<table class="table">
    <tr>
        <td>{{ form_label(form.addressline0)}}</td>
        <td>{{ form_label(form.addressline1)}}</td>
        <td>{{ form_label(form.addressline2)}}</td>
        <td>{{ form_label(form.addressline3)}}</td>
        <td>{{ form_label(form.addressline4)}}</td>
        <td>{{ form_label(form.postcode) }}</td>
    </tr>
    <tr>
        <td>{{ form_widget(form.addressline0)}}</td>
        <td>{{ form_widget(form.addressline1)}}</td>
        <td>{{ form_widget(form.addressline2)}}</td>
        <td>{{ form_widget(form.addressline3)}}</td>
        <td>{{ form_widget(form.addressline4)}}</td>
        <td>{{ form_widget(form.postcode) }}</td>
    </tr>
</table>
<table class="table">
    <tr>
        <td>{{ form_label(form.email)}}</td>
        <td>{{ form_label(form.webpage)}}</td>
        <td>{{ form_label(form.postcodefist)}}</td>
    </tr>
    <tr>
        <td>{{ form_widget(form.email)}}</td>
        <td>{{ form_widget(form.webpage)}}</td>
        <td>{{ form_widget(form.postcodefist)}}</td>
    </tr>
</table>
{% endblock body %}
{% endembed %}