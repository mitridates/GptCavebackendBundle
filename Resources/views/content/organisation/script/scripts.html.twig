{#
/**
 * @file scripts.html.twig
 */
#}
{# SEARCH/NEW/EDIT FORM #}
    {%  set fieldId = {
        'country': '#'~form.country.vars.id,
        'admin1': '#'~form.admin1.vars.id,
        'admin2': '#'~form.admin2.vars.id,
        'admin3': '#'~form.admin3.vars.id,
    }  %}

{# NEW/EDIT FORM #}
{% if form.countryaddress is defined %}
    {%  set fieldaddressId = {
        'country': '#'~form.countryaddress.vars.id,
        'admin1': '#'~form.admin1address.vars.id,
        'admin2': '#'~form.admin2address.vars.id,
        'admin3': '#'~form.admin3address.vars.id,
    }  %}
{% endif %}

<script>
$(document).ready(function() {
    {# SEARCH/NEW/EDIT FORM #}
    {#$('.country').on('change',function(){$('{{ fieldId.admin1 }}, {{ fieldId.admin2 }}, {{ fieldId.admin3 }}').val(null).trigger('change')});#}

    {#$('.admin1').select2({#}
    {#    placeholder: '{{ 'select.government.level.admin1'|trans({},'cavemessages')|raw }}',#}
    {#    'allowClear': true#}
    {#}).nestedselect2({#}
    {#    url: '{{path('cave_backend_json_admin1')}}',#}
    {#    parent: {el:'.country', row: 'countryid'},#}
    {#    defaults: {placeholder: '{{ 'select.government.level.admin1'|trans({},'cavemessages')|raw }}'}#}
    {#}).on('select2:unselecting', function(){#}
    {#    $('{{ fieldId.country }}').trigger('change');#}
    {#});#}


    {#$('.admin2').select2({#}
    {#    placeholder: '{{ 'select.government.level.admin2'|trans({},'cavemessages')|raw }}',#}
    {#    'allowClear': true#}
    {#}).nestedselect2({#}
    {#    url: '{{path('cave_backend_json_admin2')}}',#}
    {#    parent: {el:'.admin1', row: 'admin1id'},#}
    {#    defaults: {placeholder: '{{ 'select.government.level.admin2'|trans({},'cavemessages')|raw }}'}#}
    {#}).on('select2:unselecting', function(){#}
    {#    $('{{ fieldId.admin3 }}').html('');#}
    {#    $('{{ fieldId.admin1 }}').trigger('change');#}
    {#});#}

    {#$('.admin3').select2({#}
    {#    placeholder: '{{ 'select.government.level.admin3'|trans({},'cavemessages')|raw }}',#}
    {#    'allowClear': true#}
    {#}).nestedselect2({#}
    {#    url: '{{path('cave_backend_json_admin3')}}',#}
    {#    parent: {el:'.admin2', row: 'admin2id'},#}
    {#    defaults: {placeholder: '{{ 'select.government.level.admin3'|trans({},'cavemessages')|raw }}'}#}
    {#}).on('select2:unselecting', function(){#}
    {#    $('{{ fieldId.admin2 }}').trigger('change');#}
    {#});#}

{#    #}{# NEW/EDIT FORM #}
{#{% if form.countryaddress is defined %}#}

{#    $('.countryaddress').select2({#}
{#        placeholder: '{{ 'select.government.level.country'|trans({},'cavemessages')|raw }}',#}
{#        'allowClear': true#}
{#    }).on('select2:unselecting', function(){#}
{#        $('{{ fieldaddressId.admin1 }}, {{ fieldaddressId.admin2 }}, {{ fieldaddressId.admin3 }}').val(null).trigger('change')#}
{#    });#}
{#    #}

{#    $('.admin1address').select2({#}
{#        placeholder: '{{ 'select.government.level.admin1'|trans({},'cavemessages')|raw }}',#}
{#        'allowClear': true#}
{#    }).nestedselect2({#}
{#        url: '{{path('cave_backend_json_admin1')}}',#}
{#        parent: {el:'.countryaddress', row: 'countryid'},#}
{#        defaults: {placeholder: '{{ 'select.government.level.admin1'|trans({},'cavemessages')|raw }}'}#}
{#    }).on('select2:unselecting', function(){#}
{#        $('{{ fieldaddressId.country }}').trigger('change');#}
{#    });#}
{#    #}
{#    $('.admin2address').select2({#}
{#        placeholder: '{{ 'select.government.level.admin2'|trans({},'cavemessages')|raw }}',#}
{#        'allowClear': true#}
{#    }).nestedselect2({#}
{#        url: '{{path('cave_backend_json_admin2')}}',#}
{#         parent: {el:'.admin1address', row: 'admin1id'},#}
{#        defaults: {placeholder: '{{ 'select.government.level.admin2'|trans({},'cavemessages')|raw }}'}#}
{#    }).on('select2:unselecting', function(){#}
{#        $('{{ fieldaddressId.admin3 }}').html('');#}
{#        $('{{ fieldaddressId.admin1 }}').trigger('change');#}
{#    });#}


{#    $('.admin3address').select2({#}
{#        placeholder: '{{ 'select.government.level.admin3'|trans({},'cavemessages')|raw }}',#}
{#        'allowClear': true#}
{#    }).nestedselect2({#}
{#        url: '{{path('cave_backend_json_admin3')}}',#}
{#        parent: {el:'.admin2address', row: 'admin2id'},#}
{#        defaults: {placeholder: '{{ 'select.government.level.admin3'|trans({},'cavemessages')|raw }}'}#}
{#    }).on('select2:unselecting', function(){#}
{#        $('{{ fieldaddressId.admin2 }}').trigger('change');#}
{#    });#}

{#    {% endif %}#}

    Grot('.organisation*').select2paginado('{{path('cave_backend_autocomplete_organisation')}}',{placeholder: '{{'select.organisation'|trans({},'cavemessages')|raw}}'});
});
</script> 